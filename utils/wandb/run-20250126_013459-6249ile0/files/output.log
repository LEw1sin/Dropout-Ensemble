2025-01-26 01:35:00,800 - INFO - Namespace(device='cuda:1', channel_weights=[1.0, 2.0, 1.0, 1.0], batch_size=12, num_classes=4, pretrained=False, pretrained_weights='./Synapse_weights_1u1d', lr=0.0001, epochs=100, warmup_epochs=5, dataset_mode='ACDC', max_channel=256, l2_norm=1e-07, patience=15, aug=False, wandb=True, cache=True, log_dir='../../de_logistics/ACDC_1UNetlinear_1DeepLabV3Plinear_01-26-01-34-59/', log_file_path='../../de_logistics/ACDC_1UNetlinear_1DeepLabV3Plinear_01-26-01-34-59/training.log')
Epoch 1/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:43<00:00,  1.14batch/s]
2025-01-26 01:35:50,924 - INFO - train_loss:1.1996784162521363 in epoch1
2025-01-26 01:35:50,925 - INFO - train_acc:0.45823034578566985 in epoch1
2025-01-26 01:35:50,925 - INFO - Epoch 1: Learning Rate: [4e-05]
Epoch 1/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.70batch/s]
2025-01-26 01:36:05,630 - INFO - valid_loss:1.188216118812561 in epoch1
2025-01-26 01:36:05,630 - INFO - valid_acc:0.3358547034049461 in epoch1
2025-01-26 01:36:05,631 - INFO - Mean iou = 29.10% in epoch1
2025-01-26 01:36:05,631 - INFO - save the model in epoch1
Epoch 2/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:42<00:00,  1.18batch/s]
2025-01-26 01:36:47,970 - INFO - train_loss:1.1416542935371399 in epoch2
2025-01-26 01:36:47,971 - INFO - train_acc:0.6643525789742135 in epoch2
2025-01-26 01:36:47,971 - INFO - Epoch 2: Learning Rate: [6e-05]
Epoch 2/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.72batch/s]
2025-01-26 01:37:02,508 - INFO - valid_loss:1.1396506881713868 in epoch2
2025-01-26 01:37:02,508 - INFO - valid_acc:0.6933567413131339 in epoch2
2025-01-26 01:37:02,508 - INFO - Mean iou = 57.27% in epoch2
2025-01-26 01:37:02,509 - INFO - save the model in epoch2
Epoch 3/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:43<00:00,  1.16batch/s]
2025-01-26 01:37:45,767 - INFO - train_loss:1.129466676712036 in epoch3
2025-01-26 01:37:45,767 - INFO - train_acc:0.7419423915709832 in epoch3
2025-01-26 01:37:45,767 - INFO - Epoch 3: Learning Rate: [8e-05]
Epoch 3/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.71batch/s]
2025-01-26 01:38:00,356 - INFO - valid_loss:1.1334529161453246 in epoch3
2025-01-26 01:38:00,356 - INFO - valid_acc:0.7210717580569311 in epoch3
2025-01-26 01:38:00,357 - INFO - Mean iou = 59.71% in epoch3
2025-01-26 01:38:00,357 - INFO - save the model in epoch3
Epoch 4/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:42<00:00,  1.17batch/s]
2025-01-26 01:38:43,388 - INFO - train_loss:1.124901707172394 in epoch4
2025-01-26 01:38:43,389 - INFO - train_acc:0.7701708567308533 in epoch4
2025-01-26 01:38:43,389 - INFO - Epoch 4: Learning Rate: [0.0001]
Epoch 4/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.71batch/s]
2025-01-26 01:38:57,983 - INFO - valid_loss:1.1372461223602295 in epoch4
2025-01-26 01:38:57,983 - INFO - valid_acc:0.6655237254991555 in epoch4
2025-01-26 01:38:57,984 - INFO - Mean iou = 53.94% in epoch4
Epoch 5/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:43<00:00,  1.16batch/s]
2025-01-26 01:39:41,057 - INFO - train_loss:1.1215786910057068 in epoch5
2025-01-26 01:39:41,057 - INFO - train_acc:0.7954347286352267 in epoch5
2025-01-26 01:39:41,057 - INFO - Epoch 5: Learning Rate: [0.0001]
Epoch 5/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.70batch/s]
2025-01-26 01:39:55,732 - INFO - valid_loss:1.123377456665039 in epoch5
2025-01-26 01:39:55,732 - INFO - valid_acc:0.7557567558778561 in epoch5
2025-01-26 01:39:55,732 - INFO - Mean iou = 63.66% in epoch5
2025-01-26 01:39:55,733 - INFO - save the model in epoch5
Epoch 6/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:42<00:00,  1.18batch/s]
2025-01-26 01:40:38,211 - INFO - train_loss:1.1185547232627868 in epoch6
2025-01-26 01:40:38,212 - INFO - train_acc:0.818440415603214 in epoch6
2025-01-26 01:40:38,212 - INFO - Epoch 6: Learning Rate: [9.99726656007596e-05]
Epoch 6/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.73batch/s]
2025-01-26 01:40:52,649 - INFO - valid_loss:1.1226380395889282 in epoch6
2025-01-26 01:40:52,649 - INFO - valid_acc:0.7975485795166926 in epoch6
2025-01-26 01:40:52,649 - INFO - Mean iou = 68.42% in epoch6
2025-01-26 01:40:52,650 - INFO - save the model in epoch6
Epoch 7/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:42<00:00,  1.17batch/s]
2025-01-26 01:41:35,569 - INFO - train_loss:1.1169023966789247 in epoch7
2025-01-26 01:41:35,570 - INFO - train_acc:0.8300087075774486 in epoch7
2025-01-26 01:41:35,570 - INFO - Epoch 7: Learning Rate: [9.989069229280264e-05]
Epoch 7/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.70batch/s]
2025-01-26 01:41:50,320 - INFO - valid_loss:1.1185725545883178 in epoch7
2025-01-26 01:41:50,321 - INFO - valid_acc:0.8241367873053056 in epoch7
2025-01-26 01:41:50,321 - INFO - Mean iou = 71.87% in epoch7
2025-01-26 01:41:50,321 - INFO - save the model in epoch7
Epoch 8/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:43<00:00,  1.16batch/s]
2025-01-26 01:42:33,733 - INFO - train_loss:1.1142123126983643 in epoch8
2025-01-26 01:42:33,739 - INFO - train_acc:0.8501494774994863 in epoch8
2025-01-26 01:42:33,739 - INFO - Epoch 8: Learning Rate: [9.975416971273785e-05]
Epoch 8/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.62batch/s]
2025-01-26 01:42:49,201 - INFO - valid_loss:1.117967038154602 in epoch8
2025-01-26 01:42:49,202 - INFO - valid_acc:0.8366963586214446 in epoch8
2025-01-26 01:42:49,202 - INFO - Mean iou = 73.53% in epoch8
2025-01-26 01:42:49,203 - INFO - save the model in epoch8
Epoch 9/100 [Training]: 100%|███████████████████████████████████████████████████████████████████| 50/50 [00:43<00:00,  1.15batch/s]
2025-01-26 01:43:32,917 - INFO - train_loss:1.1129765009880066 in epoch9
2025-01-26 01:43:32,918 - INFO - train_acc:0.8583990095282359 in epoch9
2025-01-26 01:43:32,918 - INFO - Epoch 9: Learning Rate: [9.956324714600213e-05]
Epoch 9/100 [Validation]: 100%|█████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.67batch/s]
2025-01-26 01:43:47,896 - INFO - valid_loss:1.1170328950881958 in epoch9
2025-01-26 01:43:47,896 - INFO - valid_acc:0.8342346750143901 in epoch9
2025-01-26 01:43:47,896 - INFO - Mean iou = 73.21% in epoch9
Epoch 10/100 [Training]: 100%|██████████████████████████████████████████████████████████████████| 50/50 [00:44<00:00,  1.13batch/s]
2025-01-26 01:44:32,327 - INFO - train_loss:1.1119406294822693 in epoch10
2025-01-26 01:44:32,328 - INFO - train_acc:0.8653597813837786 in epoch10
2025-01-26 01:44:32,328 - INFO - Epoch 10: Learning Rate: [9.93181333636191e-05]
Epoch 10/100 [Validation]: 100%|████████████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.63batch/s]
2025-01-26 01:44:47,645 - INFO - valid_loss:1.1159734106063843 in epoch10
2025-01-26 01:44:47,645 - INFO - valid_acc:0.8501881623114882 in epoch10
2025-01-26 01:44:47,645 - INFO - Mean iou = 75.39% in epoch10
2025-01-26 01:44:47,646 - INFO - save the model in epoch10
Epoch 11/100 [Training]:  66%|███████████████████████████████████████████▌                      | 33/50 [00:29<00:15,  1.12batch/s]
Traceback (most recent call last):
  File "/data2/lyw/deunet_mem_based/train.py", line 217, in <module>
    main(args, net)
  File "/data2/lyw/deunet_mem_based/train.py", line 69, in main
    train_acc, train_losses = train_epoch(args, net, optimizer, train_loader, device, epoch, scheduler)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/lyw/deunet_mem_based/train.py", line 140, in train_epoch
    train_losses, train_acc, _= process_epoch(args, net, train_loader, device, 'train', optimizer, scaler, scheduler)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/lyw/deunet_mem_based/train.py", line 107, in process_epoch
    pred = net(image, valid_mask)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/lyw/deunet_mem_based/model/DE_framework.py", line 104, in forward
    img_ = img[valid_mask].unsqueeze(1)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/lyw/deunet_mem_based/model/DE_framework.py", line 130, in weighted_avg
    return final_output
                   ^^^^^
KeyboardInterrupt
