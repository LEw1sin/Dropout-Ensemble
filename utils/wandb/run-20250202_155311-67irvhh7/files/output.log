2025-02-02 15:53:12,521 - INFO - Namespace(device='cuda:3', channel_weights=[1.0, 2.0, 1.0, 1.0], batch_size=8, num_classes=4, pretrained=False, pretrained_weights='./Synapse_weights_1u1d', lr=0.0001, epochs=500, warmup_epochs=10, dataset_mode='ACDC', max_channel=256, l2_norm=1e-07, patience=15, aug=False, wandb=True, cache=True, log_dir='../../de_logistics/ACDC_1UNetlinear_02-02-15-53-11/', log_file_path='../../de_logistics/ACDC_1UNetlinear_02-02-15-53-11/training.log')
Epoch 1/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:33<00:00,  2.23batch/s]
2025-02-02 15:53:51,106 - INFO - train_loss:1.301230370203654 in epoch1
2025-02-02 15:53:51,107 - INFO - train_acc:0.3079581281289598 in epoch1
2025-02-02 15:53:51,107 - INFO - Epoch 1: Learning Rate: [2e-05]
Epoch 1/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.76batch/s]
2025-02-02 15:53:55,816 - INFO - valid_loss:1.235738103206341 in epoch1
2025-02-02 15:53:55,816 - INFO - valid_acc:0.41577232803906405 in epoch1
2025-02-02 15:53:55,817 - INFO - Mean iou = 34.47% in epoch1
2025-02-02 15:53:55,818 - INFO - save the model in epoch1
Epoch 2/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:33<00:00,  2.26batch/s]
2025-02-02 15:54:29,031 - INFO - train_loss:1.2170698245366414 in epoch2
2025-02-02 15:54:29,031 - INFO - train_acc:0.5080688907746252 in epoch2
2025-02-02 15:54:29,031 - INFO - Epoch 2: Learning Rate: [3e-05]
Epoch 2/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.58batch/s]
2025-02-02 15:54:34,065 - INFO - valid_loss:1.208122418476985 in epoch2
2025-02-02 15:54:34,065 - INFO - valid_acc:0.5750235579867841 in epoch2
2025-02-02 15:54:34,066 - INFO - Mean iou = 49.06% in epoch2
2025-02-02 15:54:34,067 - INFO - save the model in epoch2
Epoch 3/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.31batch/s]
2025-02-02 15:55:06,547 - INFO - train_loss:1.1902692635854086 in epoch3
2025-02-02 15:55:06,547 - INFO - train_acc:0.7091432141686432 in epoch3
2025-02-02 15:55:06,547 - INFO - Epoch 3: Learning Rate: [4e-05]
Epoch 3/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.53batch/s]
2025-02-02 15:55:11,679 - INFO - valid_loss:1.1763876951657808 in epoch3
2025-02-02 15:55:11,680 - INFO - valid_acc:0.7398198485077955 in epoch3
2025-02-02 15:55:11,680 - INFO - Mean iou = 61.67% in epoch3
2025-02-02 15:55:11,680 - INFO - save the model in epoch3
Epoch 4/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:33<00:00,  2.27batch/s]
2025-02-02 15:55:44,783 - INFO - train_loss:1.1759835036595663 in epoch4
2025-02-02 15:55:44,783 - INFO - train_acc:0.796436290017524 in epoch4
2025-02-02 15:55:44,783 - INFO - Epoch 4: Learning Rate: [5e-05]
Epoch 4/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.65batch/s]
2025-02-02 15:55:49,690 - INFO - valid_loss:1.1696409628941462 in epoch4
2025-02-02 15:55:49,690 - INFO - valid_acc:0.8483265744453211 in epoch4
2025-02-02 15:55:49,690 - INFO - Mean iou = 75.26% in epoch4
2025-02-02 15:55:49,691 - INFO - save the model in epoch4
Epoch 5/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.31batch/s]
2025-02-02 15:56:22,167 - INFO - train_loss:1.169890635808309 in epoch5
2025-02-02 15:56:22,167 - INFO - train_acc:0.830784750612417 in epoch5
2025-02-02 15:56:22,167 - INFO - Epoch 5: Learning Rate: [6e-05]
Epoch 5/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.73batch/s]
2025-02-02 15:56:26,931 - INFO - valid_loss:1.1616809643231905 in epoch5
2025-02-02 15:56:26,931 - INFO - valid_acc:0.8344290819080117 in epoch5
2025-02-02 15:56:26,931 - INFO - Mean iou = 73.32% in epoch5
Epoch 6/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.29batch/s]
2025-02-02 15:56:59,692 - INFO - train_loss:1.166376404762268 in epoch6
2025-02-02 15:56:59,692 - INFO - train_acc:0.8505963386610146 in epoch6
2025-02-02 15:56:59,693 - INFO - Epoch 6: Learning Rate: [7e-05]
Epoch 6/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.57batch/s]
2025-02-02 15:57:04,756 - INFO - valid_loss:1.1585508493276744 in epoch6
2025-02-02 15:57:04,757 - INFO - valid_acc:0.8709007595592849 in epoch6
2025-02-02 15:57:04,757 - INFO - Mean iou = 78.29% in epoch6
2025-02-02 15:57:04,758 - INFO - save the model in epoch6
Epoch 7/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.28batch/s]
2025-02-02 15:57:37,755 - INFO - train_loss:1.1638927364349365 in epoch7
2025-02-02 15:57:37,755 - INFO - train_acc:0.8675680267225975 in epoch7
2025-02-02 15:57:37,755 - INFO - Epoch 7: Learning Rate: [8e-05]
Epoch 7/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.73batch/s]
2025-02-02 15:57:42,522 - INFO - valid_loss:1.157176943925711 in epoch7
2025-02-02 15:57:42,522 - INFO - valid_acc:0.8647454922253325 in epoch7
2025-02-02 15:57:42,522 - INFO - Mean iou = 77.40% in epoch7
Epoch 8/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.31batch/s]
2025-02-02 15:58:14,932 - INFO - train_loss:1.1636504872639974 in epoch8
2025-02-02 15:58:14,933 - INFO - train_acc:0.8667814460196704 in epoch8
2025-02-02 15:58:14,933 - INFO - Epoch 8: Learning Rate: [9e-05]
Epoch 8/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.71batch/s]
2025-02-02 15:58:19,730 - INFO - valid_loss:1.1568674307603102 in epoch8
2025-02-02 15:58:19,730 - INFO - valid_acc:0.8739090329144754 in epoch8
2025-02-02 15:58:19,731 - INFO - Mean iou = 78.59% in epoch8
2025-02-02 15:58:19,731 - INFO - save the model in epoch8
Epoch 9/500 [Training]: 100%|██████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.30batch/s]
2025-02-02 15:58:52,355 - INFO - train_loss:1.16151047706604 in epoch9
2025-02-02 15:58:52,355 - INFO - train_acc:0.8804181255066255 in epoch9
2025-02-02 15:58:52,356 - INFO - Epoch 9: Learning Rate: [0.0001]
Epoch 9/500 [Validation]: 100%|████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.75batch/s]
2025-02-02 15:58:57,091 - INFO - valid_loss:1.1572368144989014 in epoch9
2025-02-02 15:58:57,091 - INFO - valid_acc:0.8935447156950187 in epoch9
2025-02-02 15:58:57,091 - INFO - Mean iou = 81.64% in epoch9
2025-02-02 15:58:57,092 - INFO - save the model in epoch9
Epoch 10/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.31batch/s]
2025-02-02 15:59:29,654 - INFO - train_loss:1.1601630131403604 in epoch10
2025-02-02 15:59:29,655 - INFO - train_acc:0.8902575133291746 in epoch10
2025-02-02 15:59:29,655 - INFO - Epoch 10: Learning Rate: [0.0001]
Epoch 10/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.59batch/s]
2025-02-02 15:59:34,676 - INFO - valid_loss:1.1554747636501606 in epoch10
2025-02-02 15:59:34,677 - INFO - valid_acc:0.8828757470445563 in epoch10
2025-02-02 15:59:34,677 - INFO - Mean iou = 80.07% in epoch10
Epoch 11/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.29batch/s]
2025-02-02 16:00:07,429 - INFO - train_loss:1.1611756292978923 in epoch11
2025-02-02 16:00:07,430 - INFO - train_acc:0.8829688885682551 in epoch11
2025-02-02 16:00:07,430 - INFO - Epoch 11: Learning Rate: [9.999897245068351e-05]
Epoch 11/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.62batch/s]
2025-02-02 16:00:12,386 - INFO - valid_loss:1.1550808136279767 in epoch11
2025-02-02 16:00:12,386 - INFO - valid_acc:0.8865131239488532 in epoch11
2025-02-02 16:00:12,387 - INFO - Mean iou = 80.44% in epoch11
Epoch 12/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.28batch/s]
2025-02-02 16:00:45,244 - INFO - train_loss:1.158811821937561 in epoch12
2025-02-02 16:00:45,244 - INFO - train_acc:0.9037779252543139 in epoch12
2025-02-02 16:00:45,244 - INFO - Epoch 12: Learning Rate: [9.999588984497258e-05]
Epoch 12/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.67batch/s]
2025-02-02 16:00:50,113 - INFO - valid_loss:1.1528869500527015 in epoch12
2025-02-02 16:00:50,114 - INFO - valid_acc:0.8995268249656403 in epoch12
2025-02-02 16:00:50,114 - INFO - Mean iou = 82.49% in epoch12
2025-02-02 16:00:50,115 - INFO - save the model in epoch12
Epoch 13/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.29batch/s]
2025-02-02 16:01:22,929 - INFO - train_loss:1.1588765366872151 in epoch13
2025-02-02 16:01:22,930 - INFO - train_acc:0.9020565776331989 in epoch13
2025-02-02 16:01:22,930 - INFO - Epoch 13: Learning Rate: [9.999075230958104e-05]
Epoch 13/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.62batch/s]
2025-02-02 16:01:27,902 - INFO - valid_loss:1.153903420154865 in epoch13
2025-02-02 16:01:27,902 - INFO - valid_acc:0.8907446747706776 in epoch13
2025-02-02 16:01:27,902 - INFO - Mean iou = 81.22% in epoch13
Epoch 14/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.30batch/s]
2025-02-02 16:02:00,559 - INFO - train_loss:1.1582704544067384 in epoch14
2025-02-02 16:02:00,559 - INFO - train_acc:0.9081641697358153 in epoch14
2025-02-02 16:02:00,559 - INFO - Epoch 14: Learning Rate: [9.998356005569284e-05]
Epoch 14/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.71batch/s]
2025-02-02 16:02:05,361 - INFO - valid_loss:1.1566657653221717 in epoch14
2025-02-02 16:02:05,362 - INFO - valid_acc:0.8528900924966355 in epoch14
2025-02-02 16:02:05,362 - INFO - Mean iou = 75.60% in epoch14
Epoch 15/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:33<00:00,  2.27batch/s]
2025-02-02 16:02:38,391 - INFO - train_loss:1.1584049638112386 in epoch15
2025-02-02 16:02:38,392 - INFO - train_acc:0.9058383138175164 in epoch15
2025-02-02 16:02:38,392 - INFO - Epoch 15: Learning Rate: [9.99743133789534e-05]
Epoch 15/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.65batch/s]
2025-02-02 16:02:43,307 - INFO - valid_loss:1.1524248123168945 in epoch15
2025-02-02 16:02:43,308 - INFO - valid_acc:0.908181608434412 in epoch15
2025-02-02 16:02:43,308 - INFO - Mean iou = 83.84% in epoch15
2025-02-02 16:02:43,309 - INFO - save the model in epoch15
Epoch 16/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:33<00:00,  2.26batch/s]
2025-02-02 16:03:16,620 - INFO - train_loss:1.1576408100128175 in epoch16
2025-02-02 16:03:16,621 - INFO - train_acc:0.9135909165661481 in epoch16
2025-02-02 16:03:16,621 - INFO - Epoch 16: Learning Rate: [9.996301265945735e-05]
Epoch 16/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.72batch/s]
2025-02-02 16:03:21,410 - INFO - valid_loss:1.1523693616573627 in epoch16
2025-02-02 16:03:21,411 - INFO - valid_acc:0.9209313346793834 in epoch16
2025-02-02 16:03:21,411 - INFO - Mean iou = 85.89% in epoch16
2025-02-02 16:03:21,412 - INFO - save the model in epoch16
Epoch 17/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:32<00:00,  2.31batch/s]
2025-02-02 16:03:53,961 - INFO - train_loss:1.1572602955500284 in epoch17
2025-02-02 16:03:53,961 - INFO - train_acc:0.9164365615100498 in epoch17
2025-02-02 16:03:53,961 - INFO - Epoch 17: Learning Rate: [9.994965836173304e-05]
Epoch 17/500 [Validation]: 100%|███████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.57batch/s]
2025-02-02 16:03:59,016 - INFO - valid_loss:1.1519293601696308 in epoch17
2025-02-02 16:03:59,016 - INFO - valid_acc:0.9155864658353607 in epoch17
2025-02-02 16:03:59,016 - INFO - Mean iou = 84.97% in epoch17
Epoch 18/500 [Training]: 100%|█████████████████████████████████████████████████████████████| 75/75 [00:33<00:00,  2.26batch/s]
2025-02-02 16:04:32,171 - INFO - train_loss:1.1568128728866578 in epoch18
2025-02-02 16:04:32,172 - INFO - train_acc:0.9207097648759744 in epoch18
2025-02-02 16:04:32,172 - INFO - Epoch 18: Learning Rate: [9.99342510347233e-05]
Epoch 18/500 [Validation]:   0%|                                                                    | 0/13 [00:00<?, ?batch/s]
Traceback (most recent call last):
  File "/data2/lyw/deunet_mem_based/train.py", line 218, in <module>
    main(args, net)
  File "/data2/lyw/deunet_mem_based/train.py", line 73, in main
    valid_losses, valid_acc = valid_epoch(args, net, valid_loader, device, epoch)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data2/lyw/deunet_mem_based/train.py", line 156, in valid_epoch
    valid_losses, valid_acc, miou = process_epoch(args, net, valid_loader, device, 'valid')
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/lyw/deunet_mem_based/train.py", line 97, in process_epoch
    for step, data_batch in enumerate(loader):
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
                ^^^^^^^^^^^^^^^^
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1402, in _get_data
    success, data = self._try_get_data()
                    ^^^^^^^^^^^^^^^^^^^^
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1243, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/home/lyw/anaconda3/envs/unet/lib/python3.11/threading.py", line 331, in wait
    gotit = waiter.acquire(True, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
